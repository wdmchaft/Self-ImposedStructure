////  admain.m//  AppleMailDaemon////  Created by Charles on 11/17/10.//  Copyright 2010 zer0gravitas.com. All rights reserved.//#import <Cocoa/Cocoa.h>#import <Foundation/Foundation.h>#import "MailEventHandler.h"#import "ScriptDaemon.h"int main (int argc, const char * argv[]) {	NSLog(@"AppleMailDaemon in the beginning.");	NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];		@try {			MailEventHandler *meHandler = [MailEventHandler new];            NSDictionary *handlers = [NSDictionary dictionaryWithObjectsAndKeys:meHandler, @"mail", nil];			ScriptDaemon *daemon = [[[ScriptDaemon alloc]initWithName:@"com.zer0gravitas.applemaildaemon"]retain];			[daemon setHandlerMap:handlers];			[daemon loop:pool];		}		@catch (NSException * e) {			NSLog(@"exception in AppleMailDaemon: %@", e);					}		@finally {			[[NSUserDefaults standardUserDefaults] removeObjectForKey:@"running"];			[[NSUserDefaults standardUserDefaults] synchronize];		}		[pool drain];    return 0;}